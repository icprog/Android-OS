<font face="黑体">
## 平台：BD6739_66_A_N
## 指纹库的整体目录结构
	alps/bird/prebuilts/external/birdfp/cdfinger/fps988e/
	├── Android.mk
	├── cdfingerproduct.mk
	├── init.cdfinger.rc
	├── libs
	│     ├── cdfingerdaemon
	│     ├── cdfinger.default.so
	│     ├── cdfinger.fingerprint.default.so
	│     ├── fingerprint.default.so
	│     ├── libcfpalgo_x56.so
	│     ├── libcfpalgo_x80.so
	│     ├── libcfpalgo_x98.so
	│     ├── libcfp_factory.so
	│     ├── libcfp_proxy.so
	│     ├── libcfpservice.so
	│     └── Readme.txt
	└── sepolicy
	        ├── cdfinger.te
	        ├── device.te
	        ├── file_contexts
	        ├── file.te
	        ├── fingerprintd.te
	        ├── property_contexts
	        ├── property.te
	        ├── service_contexts
	        └── service.te
## 移植分4个重点部分：
*  移植使用的mk
#
	1.Android.mk【一般不推荐】
		1.可以直接编译，不用include、call inhert-product。
		LOCAL_PATH:= $(call my-dir)
		include $(CLEAR_VARS)
		LOCAL_MODULE := chipsailing.fingerprint.default
		LOCAL_SRC_FILES := ./lib64/hw/$(LOCAL_MODULE).so
		LOCAL_MODULE_TAGS := optional
		LOCAL_MODULE_SUFFIX := .so
		LOCAL_MULTILIB :=64
		LOCAL_MODULE_CLASS := SHARED_LIBRARIES
		LOCAL_MODULE_PATH := $(TARGET_OUT)/lib64/hw
		OVERRIDE_BUILT_MODULE_PATH := $(TARGET_OUT_INTERMEDIATE_LIBRARIES)
		include $(BUILD_PREBUILT)
		2.可以使用宏控：
		3.但不能直接复制文件
	2.普通mk【推荐】
		1.不可以直接编译，需要include
		如:
		可以在device.mk或fingerprint.mk【也是在device.mk中添加的】中：include或call inherit-product
		$(call inherit-product, device/mediatek/mt6739/fingerprint.mk)

		include device/cdfinger/cdfingerproduct.mk
		$(call inherit-product, device/cdfinger/cdfingerproduct.mk)
		
		在fingerprint.mk中使用宏控要注意：
		一定切记使用filter过滤的形式：兼容多个也没问题
		ifneq ($(filter $(BIRD_SUPPORT_FP_CHIP), cdfinger),)
	    不要用strip取值的形式：不能兼容多个
		ifeq ($(strip $(BIRD_SUPPORT_FP_CHIP)),sunwave)

		# add for fps988e start
		ifneq ($(filter $(BIRD_SUPPORT_FP_CHIP), cdfinger),)
		ifneq ($(filter $(BIRD_SUPPORT_FP_SENSOR), fps988e),)
		$(call inherit-product, bird/prebuilts/external/birdfp/cdfinger/fps988e/cdfingerproduct.mk)
		endif
		endif
		# add for fps988e end
		
		
### 库:
	以.so结尾的文件就是库文件。
	libfingerprint.default.so（Android 原生 hal 层， lib/hw）
	libcfp_proxy.so（proxy 库， lib 目录下）
	libcfpservice.so（service 库， lib 目录下）
	libcdfinger.default.so（hal 层， lib/hw）
	libcfpalgo.so（算法库， lib 目录下）
### 权限
	BOARD_SEPOLICY_DIRS 将会把权限加入源码中。 修改权限后第一
	编译需要删除之前的中间文件， 保证改动生效。
	rm -rf out/target/product/xxxx/obj/ETC/sepolicy_intermediates

	不能开机
	abd shell ps | grep cdfingerdaemon 查看 cdfingerdaemon 进程是否存
	在，若不存在，重启时adb wait-for-device shell setenforce 0关闭 Selinux
	权限， 如果可以开机， 则说明 Selinux 权限配置有问题， 如果还不能开机， 
	请检查添加的 init.rc 是否生效。

### 没有指纹菜单
	1) 检查驱动是否调试成功， adb shell ls dev/fpsdev0 检查是否有指纹
	设备节点。【一般在dev/目录下ls -Z|grep fp】
	2) 在 system/lib/hw 或 system/lib64/hw 目录下检查是否有
	fingerprint.default.so 或 cdfinger.fingerprint.default.so 文件。 如果没有，
	检查移植方式中添加库的步骤是否生效。
	3) adb shell service list | grep IFingerprintService 查看是否有 andro
	id.hardware.fingerprint.IFingerprintService 服务。 如果没有， 检查 
	cdfinger_product_32bit.mk / cdfinger_product_64bit.mk 中 PRODUCT_COPY_FILES
	 += frameworks/native/data/etc/android.hardware.fingerprint.xml:
	system/etc/permissions/android.hardware.fingerprint.xml 是否生效。
	4) adb shell service list | grep IFingerprintDaemon 查看是否有
	android.hardware.fingerprint.IFingerprintDaemon 服务， 如果没有， 检
	查 init.cdfinger.rc 中 service fingerprintd /system/bin/fingerprintd 是否生
	效。【可以直接ps -Z|grep fingerprintd】
### 不能注册
	检查 system/lib/hw 或 system/lib64/hw 目录下的 fingerprint.default.so
	是否为费恩格尔指纹的 HAL 库， 如果不是， 检查移植方式中添加库的步骤是否生效， 
	如果已经生效， 检查是不是编译时被其它厂商的指纹 HAL 库所覆盖。
</font>